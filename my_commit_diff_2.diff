commit d272f4e2ea7f44a8f312511c7c0ae84bbc5f795b
Author: Skottbie T. <307495077@qq.com>
Date:   Sun Aug 24 16:35:13 2025 +0800

    æ•™å¸ˆDashboard è®¾è®¡ä¼˜åŒ–

diff --git a/client/src/pages/TeacherDashboard.jsx b/client/src/pages/TeacherDashboard.jsx
index dbb4f56..2053498 100644
--- a/client/src/pages/TeacherDashboard.jsx
+++ b/client/src/pages/TeacherDashboard.jsx
@@ -12,7 +12,7 @@ import PullToRefreshContainer from '../components/PullToRefreshContainer';
 import useAutoRefresh from '../hooks/useAutoRefresh';
 import { getGreeting } from '../utils/greetings';
 import NicknamePrompt from '../components/NicknamePrompt';
-
+import React from 'react';
 import { 
   // ä¸StudentDashboardä¸€è‡´çš„å›¾æ ‡
   ClipboardList,    // ğŸ“‹ æ›¿æ¢ (ä»»åŠ¡æè¿°ã€æäº¤è¦æ±‚ã€æ´»è·ƒä»»åŠ¡)
@@ -23,6 +23,7 @@ import {
   BookOpen,         // ğŸ“š æ›¿æ¢ (æˆ‘çš„ç­çº§ã€è¯¾ç¨‹ä»»åŠ¡)
   FileText,         // ğŸ“ æ›¿æ¢ (æŸ¥çœ‹æäº¤ã€è¯¾å ‚ç»ƒä¹ )
   Clock3,           // ğŸ• æ›¿æ¢ (å¼€å‘ç¯å¢ƒæ—¶é—´æ˜¾ç¤º)
+  ChevronDown,      // ğŸ†• æ–°å¢ï¼šç”¨äºæŠ˜å åŠŸèƒ½
   
   // TeacherDashboardæ–°å¢çš„å›¾æ ‡
   BarChart3,        // ğŸ“Š æ›¿æ¢ (ç­çº§ç»Ÿè®¡ã€çŠ¶æ€ä¿¡æ¯)
@@ -36,6 +37,66 @@ import {
   GraduationCap     // ğŸ« æ›¿æ¢ (å…³è”ç­çº§)
 } from 'lucide-react';
 
+
+  const CollapsibleSection = React.memo(({ title, count, type, isCollapsed, onToggle, children }) => {
+    // æ ¹æ®ç±»å‹é€‰æ‹©å›¾æ ‡å’Œé¢œè‰²ä¸»é¢˜
+    const getTheme = () => {
+      if (type === 'expired') {
+        return {
+          icon: <X className="w-4 h-4 text-red-600 dark:text-red-400" />,
+          bgColor: 'bg-red-50 dark:bg-gray-800/50 border border-red-100 dark:border-gray-700',
+          hoverBg: 'hover:bg-red-100 dark:hover:bg-gray-700/50'
+        };
+      } else {
+        return {
+          icon: <Clock className="w-4 h-4 text-blue-600 dark:text-blue-400" />,
+          bgColor: 'bg-blue-50 dark:bg-gray-800/50 border border-blue-100 dark:border-gray-700', 
+          hoverBg: 'hover:bg-blue-100 dark:hover:bg-gray-700/50'
+        };
+      }
+    };
+
+    const theme = getTheme();
+
+    return (
+      <div className="space-y-3">
+        <button
+          onClick={() => onToggle(type)}
+          className={`w-full flex items-center justify-between p-3 rounded-xl transition-all duration-200 ${theme.bgColor} ${theme.hoverBg}`}
+        >
+          <div className="flex items-center gap-3">
+            {theme.icon}
+            <span className="font-medium text-gray-800 dark:text-gray-200">
+              {title} ({count})
+            </span>
+          </div>
+          <motion.div
+            animate={{ rotate: isCollapsed ? 0 : 180 }}
+            transition={{ duration: 0.2 }}
+          >
+            <ChevronDown className="w-4 h-4 text-gray-500 dark:text-gray-400" />
+          </motion.div>
+        </button>
+        
+        <AnimatePresence>
+          {!isCollapsed && (
+            <motion.div
+              initial={{ height: 0, opacity: 0 }}
+              animate={{ height: "auto", opacity: 1 }}
+              exit={{ height: 0, opacity: 0 }}
+              transition={{ duration: 0.3, ease: "easeInOut" }}
+              style={{ overflow: "hidden" }}
+            >
+              <div className="space-y-4 pl-2">
+                {children}
+              </div>
+            </motion.div>
+          )}
+        </AnimatePresence>
+      </div>
+    );
+  });
+
 const TeacherDashboard = () => {
   const [user, setUser] = useState(null);
   const [form, setForm] = useState({
@@ -74,6 +135,28 @@ const TeacherDashboard = () => {
   const [showBatchModal, setShowBatchModal] = useState(false);
   const [batchOperation, setBatchOperation] = useState('');
   const [batchLoading, setBatchLoading] = useState(false);
+    // ğŸš€ æå‰è®¡ç®—å½“å‰ä»»åŠ¡åˆ—è¡¨
+  const currentTasks = useMemo(() => tasks[currentCategory] || [], [tasks, currentCategory]);
+
+  // ğŸ“Œ æ–°å¢ï¼šæŠ˜å çŠ¶æ€ç®¡ç†
+  const [isNewTaskFormCollapsed, setIsNewTaskFormCollapsed] = useState(true); // å‘å¸ƒæ–°ä»»åŠ¡è¡¨å•é»˜è®¤æŠ˜å 
+  const [activeTasksCollapsed, setActiveTasksCollapsed] = useState({
+    expired: false,     // å·²æˆªæ­¢ä»»åŠ¡é»˜è®¤å±•å¼€  
+    notExpired: true    // æœªæˆªæ­¢ä»»åŠ¡é»˜è®¤æŠ˜å 
+  });
+
+  // ğŸ“Œ æ–°å¢ï¼šåˆ‡æ¢è¡¨å•æŠ˜å çŠ¶æ€
+  const toggleNewTaskForm = useCallback(() => {
+    setIsNewTaskFormCollapsed(prev => !prev);
+  }, []);
+
+  // ğŸ“Œ æ–°å¢ï¼šåˆ‡æ¢æ´»è·ƒä»»åŠ¡åˆ†ç»„æŠ˜å çŠ¶æ€
+  const toggleActiveTasksGroup = useCallback((type) => {
+    setActiveTasksCollapsed(prev => ({
+      ...prev,
+      [type]: !prev[type]
+    }));
+  }, []);
   
   const navigate = useNavigate();
   const [myClasses, setMyClasses] = useState([]);
@@ -148,6 +231,24 @@ const TeacherDashboard = () => {
     fetchInitialData();
   }, [fetchInitialData]);
 
+
+
+  // ğŸ†• æ–°å¢ï¼šæ´»è·ƒä»»åŠ¡åˆ†ç»„ï¼ˆåªåœ¨activeåˆ†ç±»ä¸‹ç”Ÿæ•ˆï¼‰
+  const groupedActiveTasks = useMemo(() => {
+      if (currentCategory !== 'active') {
+        return null; // éæ´»è·ƒä»»åŠ¡åˆ†ç±»ä¸åˆ†ç»„
+      }
+      
+      const now = new Date();
+      const expired = currentTasks.filter(task => new Date(task.deadline) <= now);
+      const notExpired = currentTasks.filter(task => new Date(task.deadline) > now);
+      
+      return {
+        expired,
+        notExpired
+      };
+    }, [currentTasks, currentCategory]);
+
   // ğŸ“Œ è·å–ä»»åŠ¡å‡½æ•° - ä¼˜åŒ–ä¸ºåªåœ¨éœ€è¦æ—¶è¯·æ±‚
   const fetchTasks = useCallback(async (category = 'active') => {
     try {
@@ -439,8 +540,7 @@ const TeacherDashboard = () => {
     }
   }, []);
 
-  // ğŸš€ æå‰è®¡ç®—å½“å‰ä»»åŠ¡åˆ—è¡¨
-  const currentTasks = useMemo(() => tasks[currentCategory] || [], [tasks, currentCategory]);
+
 
 // ğŸ“Œ ç§»åŠ¨ç«¯ä»»åŠ¡å¡ç‰‡æ¸²æŸ“å‡½æ•°
   const renderMobileTaskCard = useCallback((task) => {
@@ -896,11 +996,33 @@ const TeacherDashboard = () => {
             animate={{ opacity: 1, y: 0 }}
             transition={{ delay: 0.1 }}
             className="bg-gradient-to-r from-white via-blue-50/30 to-purple-50/30 dark:from-gray-800 dark:via-blue-900/10 dark:to-purple-900/10 rounded-mobile-2xl border border-gray-200/60 dark:border-gray-700/60 backdrop-blur-xl shadow-mobile p-6"
+            style={{ paddingBottom: '0.5rem' }}
           >
-          <h2 className="text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4 flex items-center gap-2">
+          <button
+            onClick={toggleNewTaskForm}
+            className="w-full flex items-center justify-between mb-4 p-2 -m-2 rounded-lg hover:bg-black/5 dark:hover:bg-white/5 transition-colors aigc-native-button"
+          >
+            <h2 className="text-lg font-semibold text-gray-800 dark:text-gray-100 flex items-center gap-2">
               <Pin className="w-5 h-5 text-blue-600 dark:text-blue-400" />
               å‘å¸ƒæ–°ä»»åŠ¡
             </h2>
+            <motion.div
+              animate={{ rotate: isNewTaskFormCollapsed ? 0 : 180 }}
+              transition={{ duration: 0.2 }}
+            >
+              <ChevronDown className="w-5 h-5 text-gray-500 dark:text-gray-400" />
+            </motion.div>
+          </button>
+
+          <AnimatePresence>
+            {!isNewTaskFormCollapsed && (
+              <motion.div
+                initial={{ height: 0, opacity: 0 }}
+                animate={{ height: "auto", opacity: 1 }}
+                exit={{ height: 0, opacity: 0 }}
+                transition={{ duration: 0.3, ease: "easeInOut" }}
+                style={{ overflow: "hidden" }}
+              >
 
             <form onSubmit={handleSubmit} className="space-y-6">
               {/* åŸºç¡€ä¿¡æ¯ */}
@@ -1134,6 +1256,12 @@ const TeacherDashboard = () => {
                 </div>
               )}
             </form>
+            </motion.div>
+              )}
+            </AnimatePresence>
+
+
+
           </motion.div>
 
           {/* ä»»åŠ¡ç®¡ç†åŒºåŸŸ */}
@@ -1276,7 +1404,7 @@ const TeacherDashboard = () => {
                     </PrimaryButton>
                   )}
                 </motion.div>
-              ) : (
+                  ) : (
                 <motion.div
                   key="tasks"
                   initial={{ opacity: 0 }}
@@ -1284,285 +1412,875 @@ const TeacherDashboard = () => {
                   exit={{ opacity: 0 }}
                   className="space-y-4"
                 >
-                  {currentTasks.map((task, index) => (
-                    isMobile ? (
-                      <motion.div
-                        key={task._id}
-                        initial={{ opacity: 0, y: 20 }}
-                        animate={{ opacity: 1, y: 0 }}
-                        transition={{ delay: index * 0.05 }}
-                      >
-                        {renderMobileTaskCard(task)}
-                      </motion.div>
-                    ) : (
-                      // ä¿æŒåŸæœ‰çš„æ¡Œé¢ç«¯æ¸²æŸ“é€»è¾‘
-                      <motion.div
-                        key={task._id}
-                        initial={{ opacity: 0, y: 20 }}
-                        animate={{ opacity: 1, y: 0 }}
-                        transition={{ delay: index * 0.05 }}
-                        className="bg-white dark:bg-gray-800 rounded-2xl shadow-md p-6 border border-gray-200 dark:border-gray-700"
-                      >
-                        {/* æ¡Œé¢ç«¯ä»»åŠ¡å¡ç‰‡å†…å®¹ä¿æŒä¸å˜ */}
-                        <div className="flex items-start gap-4">
-                          {/* é€‰æ‹©æ¡† */}
-                          <div className="flex-shrink-0 pt-1">
-                            <input
-                              type="checkbox"
-                              checked={selectedTasks.has(task._id)}
-                              onChange={() => toggleTaskSelection(task._id)}
-                              className="form-checkbox checkbox-lg"
-                            />
-                          </div>
+                  {/* ğŸ†• æ´»è·ƒä»»åŠ¡åˆ†ç»„æ˜¾ç¤º */}
+                  {currentCategory === 'active' && groupedActiveTasks ? (
+                    <div className="space-y-6">
+                      {/* å·²æˆªæ­¢ä»»åŠ¡åŒºåŸŸ */}
+                      {groupedActiveTasks.expired.length > 0 && (
+                        <CollapsibleSection
+                          key="expired-section"
+                          title="å·²æˆªæ­¢ä½œä¸š"
+                          count={groupedActiveTasks.expired.length}
+                          type="expired"
+                          isCollapsed={activeTasksCollapsed.expired}
+                          onToggle={toggleActiveTasksGroup}
+                        >
+                          {groupedActiveTasks.expired.map((task, index) => (
+                            isMobile ? (
+                              <motion.div
+                                key={task._id}
+                                initial={{ opacity: 0, y: 20 }}
+                                animate={{ opacity: 1, y: 0 }}
+                                transition={{ delay: index * 0.05 }}
+                              >
+                                {renderMobileTaskCard(task)}
+                              </motion.div>
+                            ) : (
+                              // ä¿æŒåŸæœ‰çš„æ¡Œé¢ç«¯æ¸²æŸ“é€»è¾‘
+                              <motion.div
+                                key={task._id}
+                                initial={{ opacity: 0, y: 20 }}
+                                animate={{ opacity: 1, y: 0 }}
+                                transition={{ delay: index * 0.05 }}
+                                className="bg-white dark:bg-gray-800 rounded-2xl shadow-md p-6 border border-gray-200 dark:border-gray-700"
+                              >
+                                {/* æ¡Œé¢ç«¯ä»»åŠ¡å¡ç‰‡å†…å®¹ä¿æŒä¸å˜ */}
+                                <div className="flex items-start gap-4">
+                                  {/* é€‰æ‹©æ¡† */}
+                                  <div className="flex-shrink-0 pt-1">
+                                    <input
+                                      type="checkbox"
+                                      checked={selectedTasks.has(task._id)}
+                                      onChange={() => toggleTaskSelection(task._id)}
+                                      className="form-checkbox checkbox-lg"
+                                    />
+                                  </div>
 
-                          <div className="flex-1 min-w-0">
-                            <div className="flex flex-col lg:flex-row lg:justify-between lg:items-start gap-4">
-                              <div className="flex-1 min-w-0">
-                                <h3 className="font-bold text-xl text-gray-800 dark:text-gray-100 mb-2 line-clamp-2">
-                                  {task.title}
-                                </h3>
-                                
-                                {/* çŠ¶æ€æ ‡ç­¾ */}
-                                <div className="flex items-center gap-2 flex-wrap mb-2">
-                                  <span className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${getTaskStatus(task.deadline).color} ${
-                                    getTaskStatus(task.deadline).status === 'expired' 
-                                      ? 'bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-700/50'
-                                      : getTaskStatus(task.deadline).status === 'urgent'
-                                      ? 'bg-orange-100 dark:bg-orange-900/30 border border-orange-200 dark:border-orange-700/50'
-                                      : getTaskStatus(task.deadline).status === 'warning'
-                                      ? 'bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-700/50'
-                                      : 'bg-green-100 dark:bg-green-900/30 border border-green-200 dark:border-green-700/50'
-                                  }`}>
-                                    {getTaskStatus(task.deadline).text}
-                                  </span>
-                                  
-                                  <span className="inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300">
-                                    {task.category}
-                                  </span>
-                                  
-                                  {currentCategory === 'deleted' && task.daysLeft !== undefined && (
-                                    <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${
-                                      task.daysLeft > 7 
-                                        ? 'bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300'
-                                        : task.daysLeft > 3
-                                        ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300'
-                                        : 'bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300'
-                                    }`}>
-                                      {task.daysLeft}å¤©åæ°¸ä¹…åˆ é™¤
-                                    </span>
-                                  )}
+                                  <div className="flex-1 min-w-0">
+                                    <div className="flex flex-col lg:flex-row lg:justify-between lg:items-start gap-4">
+                                      <div className="flex-1 min-w-0">
+                                        <h3 className="font-bold text-xl text-gray-800 dark:text-gray-100 mb-2 line-clamp-2">
+                                          {task.title}
+                                        </h3>
+                                        
+                                        {/* çŠ¶æ€æ ‡ç­¾ */}
+                                        <div className="flex items-center gap-2 flex-wrap mb-2">
+                                          <span className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${getTaskStatus(task.deadline).color} ${
+                                            getTaskStatus(task.deadline).status === 'expired' 
+                                              ? 'bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-700/50'
+                                              : getTaskStatus(task.deadline).status === 'urgent'
+                                              ? 'bg-orange-100 dark:bg-orange-900/30 border border-orange-200 dark:border-orange-700/50'
+                                              : getTaskStatus(task.deadline).status === 'warning'
+                                              ? 'bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-700/50'
+                                              : 'bg-green-100 dark:bg-green-900/30 border border-green-200 dark:border-green-700/50'
+                                          }`}>
+                                            {getTaskStatus(task.deadline).text}
+                                          </span>
+                                          
+                                          <span className="inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300">
+                                            {task.category}
+                                          </span>
+                                          
+                                          {currentCategory === 'deleted' && task.daysLeft !== undefined && (
+                                            <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${
+                                              task.daysLeft > 7 
+                                                ? 'bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300'
+                                                : task.daysLeft > 3
+                                                ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300'
+                                                : 'bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300'
+                                            }`}>
+                                              {task.daysLeft}å¤©åæ°¸ä¹…åˆ é™¤
+                                            </span>
+                                          )}
+                                        </div>
+
+                                        {/* ä»»åŠ¡æè¿° */}
+                                        {task.description && (
+                                          <div className="mb-2">
+                                            <div className="bg-blue-50/60 dark:bg-blue-900/20 rounded-mobile-lg p-3 border border-blue-200/50 dark:border-blue-700/30">
+                                              <div className="flex items-start gap-2">
+                                                <ClipboardList className="w-4 h-4 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5" />
+                                                <p className="text-sm text-blue-800 dark:text-blue-200 line-clamp-3">
+                                                  {task.description}
+                                                </p>
+                                              </div>
+                                            </div>
+                                          </div>
+                                        )}
+                                      </div>
+                                    </div>
+                                    
+                                    {/* ä»»åŠ¡è¯¦æƒ…ç½‘æ ¼ */}
+                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4">
+                                      <div className="bg-gray-50/80 dark:bg-gray-800/50 rounded-mobile-lg p-3">
+                                        <div className="text-xs text-gray-500 dark:text-gray-400 mb-1 flex items-center gap-1">
+                                          <FolderOpen className="w-3.5 h-3.5" />
+                                          ä»»åŠ¡ä¿¡æ¯
+                                        </div>
+                                        <div className="space-y-1 text-sm">
+                                          <p><span className="font-medium">ç±»å‹:</span> {task.category}</p>
+                                          <p><span className="font-medium">æ–‡ä»¶:</span> {task.needsFile ? 'å¿…äº¤' : 'æ— '}</p>
+                                          <p><span className="font-medium">AIGC:</span> {task.allowAIGC ? 'å…è®¸' : 'ç¦æ­¢'}</p>
+                                          <p><span className="font-medium">ç­çº§:</span>  {task.classIds && task.classIds.length > 0
+                                            ? task.classIds.map(cls => cls.name).join('ï¼Œ')
+                                            : 'æœªç»‘å®š'}
+                                        </p>
+                                        </div>
+                                      </div>
+
+                                      <div className="bg-gray-50/80 dark:bg-gray-800/50 rounded-mobile-lg p-3">
+                                        <div className="text-xs text-gray-500 dark:text-gray-400 mb-1 flex items-center gap-1">
+                                          <Clock className="w-3.5 h-3.5" />
+                                          æ—¶é—´è®¾ç½®
+                                        </div>
+                                        <div className="space-y-1 text-sm">
+                                          <p><span className="font-medium">æˆªæ­¢:</span> {formatDeadline(task.deadline)}</p>
+                                          <p><span className="font-medium">é€¾æœŸ:</span> {task.allowLateSubmission ? 'å…è®¸' : 'ä¸å…è®¸'}</p>
+                                        </div>
+                                      </div>
+
+                                      <div className="bg-gray-50/80 dark:bg-gray-800/50 rounded-mobile-lg p-3">
+                                        <div className="text-xs text-gray-500 dark:text-gray-400 mb-1 flex items-center gap-1">
+                                          <BarChart3 className="w-3.5 h-3.5" />
+                                          çŠ¶æ€ä¿¡æ¯
+                                        </div>
+                                        <div className="space-y-1 text-sm">
+                                          {currentCategory === 'archived' && (
+                                            <p><span className="font-medium">å­¦ç”ŸæŸ¥çœ‹:</span> {task.allowStudentViewWhenArchived ? 'å¼€æ”¾' : 'é™åˆ¶'}</p>
+                                          )}
+                                          <p><span className="font-medium">åˆ›å»º:</span> {new Date(task.createdAt).toLocaleDateString()}</p>
+                                        </div>
+                                      </div>
+                                    </div>
+                                    
+                                  {/* æ“ä½œæŒ‰é’®ç»„ */}
+                                    <div className="flex flex-wrap gap-2">
+                                      {/* æŸ¥çœ‹æäº¤è®°å½•æŒ‰é’® */}
+                                      <SecondaryButton
+                                        size="sm"
+                                        icon={<FileText className="w-4 h-4" />}
+                                        onClick={() => navigate(`/task/${task._id}/submissions`)}
+                                      >
+                                        æŸ¥çœ‹æäº¤
+                                      </SecondaryButton>
+                                      
+                                      {/* ç­çº§æäº¤æƒ…å†µæŒ‰é’® */}
+                                      <PrimaryButton
+                                        size="sm"
+                                        icon={<BarChart3 className="w-4 h-4" />}
+                                        onClick={() => navigate(`/task/${task._id}/class-status`)}
+                                      >
+                                        ç­çº§ç»Ÿè®¡
+                                      </PrimaryButton>
+
+                                        {/* æ ¹æ®ä»»åŠ¡çŠ¶æ€æ˜¾ç¤ºä¸åŒæ“ä½œæŒ‰é’® */}
+                                      {currentCategory === 'active' && (
+                                        <>
+                                          <SecondaryButton
+                                            size="sm"
+                                            icon={<Archive className="w-4 h-4" />}
+                                            onClick={() => setConfirmDialog({
+                                              isOpen: true,
+                                              title: 'ç¡®è®¤å½’æ¡£ä»»åŠ¡',
+                                              message: `ç¡®å®šè¦å½’æ¡£ä»»åŠ¡"${task.title}"å—ï¼Ÿå½’æ¡£åå­¦ç”Ÿå°†æ— æ³•æäº¤ä½œä¸šã€‚`,
+                                              onConfirm: () => {
+                                                handleTaskOperation(task._id, 'archive');
+                                                setConfirmDialog(prev => ({ ...prev, isOpen: false }));
+                                              },
+                                              confirmText: 'å½’æ¡£',
+                                              confirmVariant: 'primary'
+                                            })}
+                                            disabled={batchLoading}
+                                          >
+                                            å½’æ¡£
+                                          </SecondaryButton>
+                                          
+                                          <DangerButton
+                                            size="sm"
+                                            icon={<Trash2 className="w-4 h-4" />}
+                                            onClick={() => setConfirmDialog({
+                                              isOpen: true,
+                                              title: 'ç¡®è®¤åˆ é™¤ä»»åŠ¡',
+                                              message: `ç¡®å®šè¦åˆ é™¤ä»»åŠ¡"${task.title}"å—ï¼Ÿåˆ é™¤å30å¤©å†…å¯æ¢å¤ã€‚`,
+                                              onConfirm: () => {
+                                                handleTaskOperation(task._id, 'soft_delete');
+                                                setConfirmDialog(prev => ({ ...prev, isOpen: false }));
+                                              },
+                                              confirmText: 'åˆ é™¤',
+                                              confirmVariant: 'danger'
+                                            })}
+                                            disabled={batchLoading}
+                                          >
+                                            åˆ é™¤
+                                          </DangerButton>
+                                        </>
+                                      )}
+
+                                      {currentCategory === 'archived' && (
+                                        <>
+                                          <SecondaryButton
+                                            size="sm"
+                                            icon={<Send className="w-4 h-4" />}
+                                            onClick={() => handleTaskOperation(task._id, 'unarchive')}
+                                            disabled={batchLoading}
+                                          >
+                                            æ¢å¤
+                                          </SecondaryButton>
+                                          
+                                          <SecondaryButton
+                                            size="sm"
+                                            icon={task.allowStudentViewWhenArchived ? <Lock className="w-4 h-4" /> : <Unlock className="w-4 h-4" />}
+                                            onClick={async () => {
+                                              try {
+                                                await api.put(`/task/${task._id}/student-permission`, {
+                                                  allowStudentViewWhenArchived: !task.allowStudentViewWhenArchived
+                                                });
+                                                toast.success(' æƒé™è®¾ç½®æˆåŠŸ');
+                                                await fetchTasks(currentCategory);
+                                              } catch (err) {
+                                                toast.error(` æƒé™è®¾ç½®å¤±è´¥ï¼š${err.response?.data?.message || err.message}`);
+                                              }
+                                            }}
+                                            disabled={batchLoading}
+                                          >
+                                            {task.allowStudentViewWhenArchived ? 'é™åˆ¶æŸ¥çœ‹' : 'å¼€æ”¾æŸ¥çœ‹'}
+                                          </SecondaryButton>
+                                          
+                                          <DangerButton
+                                            size="sm"
+                                            icon={<Trash2 className="w-4 h-4" />}
+                                            onClick={() => setConfirmDialog({
+                                              isOpen: true,
+                                              title: 'ç¡®è®¤åˆ é™¤ä»»åŠ¡',
+                                              message: `ç¡®å®šè¦åˆ é™¤ä»»åŠ¡"${task.title}"å—ï¼Ÿåˆ é™¤å30å¤©å†…å¯æ¢å¤ã€‚`,
+                                              onConfirm: () => {
+                                                handleTaskOperation(task._id, 'soft_delete');
+                                                setConfirmDialog(prev => ({ ...prev, isOpen: false }));
+                                              },
+                                              confirmText: 'åˆ é™¤',
+                                              confirmVariant: 'danger'
+                                            })}
+                                            disabled={batchLoading}
+                                          >
+                                            åˆ é™¤
+                                          </DangerButton>
+                                        </>
+                                      )}
+
+                                      {currentCategory === 'deleted' && (
+                                        <>
+                                          <PrimaryButton
+                                            size="sm"
+                                            icon={<RefreshCw className="w-4 h-4" />}
+                                            onClick={() => handleTaskOperation(task._id, 'restore')}
+                                            disabled={batchLoading}
+                                          >
+                                            æ¢å¤
+                                          </PrimaryButton>
+                                          
+                                          <DangerButton
+                                            size="sm"
+                                            icon={<X className="w-4 h-4" />}
+                                            onClick={() => setConfirmDialog({
+                                              isOpen: true,
+                                              title: 'âš ï¸ æ°¸ä¹…åˆ é™¤ä»»åŠ¡',
+                                              message: `ç¡®å®šè¦æ°¸ä¹…åˆ é™¤ä»»åŠ¡"${task.title}"å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ï¼`,
+                                              onConfirm: () => {
+                                                handleTaskOperation(task._id, 'hard_delete');
+                                                setConfirmDialog(prev => ({ ...prev, isOpen: false }));
+                                              },
+                                              confirmText: 'æ°¸ä¹…åˆ é™¤',
+                                              confirmVariant: 'danger'
+                                            })}
+                                            disabled={batchLoading}
+                                          >
+                                            æ°¸ä¹…åˆ é™¤
+                                          </DangerButton>
+                                        </>
+                                      )}
+                                    </div>
+                                  </div>
                                 </div>
+                              </motion.div>
+                            )
+                          ))}
+                        </CollapsibleSection>
+                      )}
 
-                                {/* ä»»åŠ¡æè¿° */}
-                                {task.description && (
-                                  <div className="mb-2">
-                                    <div className="bg-blue-50/60 dark:bg-blue-900/20 rounded-mobile-lg p-3 border border-blue-200/50 dark:border-blue-700/30">
-                                      <div className="flex items-start gap-2">
-                                        <ClipboardList className="w-4 h-4 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5" />
-                                        <p className="text-sm text-blue-800 dark:text-blue-200 line-clamp-3">
-                                          {task.description}
+                      {/* æœªæˆªæ­¢ä»»åŠ¡åŒºåŸŸ */}
+                      {groupedActiveTasks.notExpired.length > 0 && (
+                        <CollapsibleSection
+                          key="notexpired-section"
+                          title="æœªæˆªæ­¢ä½œä¸š"
+                          count={groupedActiveTasks.notExpired.length}
+                          type="notExpired"
+                          isCollapsed={activeTasksCollapsed.notExpired}
+                          onToggle={toggleActiveTasksGroup}
+                        >
+                          {groupedActiveTasks.notExpired.map((task, index) => (
+                            isMobile ? (
+                              <motion.div
+                                key={task._id}
+                                initial={{ opacity: 0, y: 20 }}
+                                animate={{ opacity: 1, y: 0 }}
+                                transition={{ delay: index * 0.05 }}
+                              >
+                                {renderMobileTaskCard(task)}
+                              </motion.div>
+                            ) : (
+                              // ä¿æŒåŸæœ‰çš„æ¡Œé¢ç«¯æ¸²æŸ“é€»è¾‘
+                              <motion.div
+                                key={task._id}
+                                initial={{ opacity: 0, y: 20 }}
+                                animate={{ opacity: 1, y: 0 }}
+                                transition={{ delay: index * 0.05 }}
+                                className="bg-white dark:bg-gray-800 rounded-2xl shadow-md p-6 border border-gray-200 dark:border-gray-700"
+                              >
+                                {/* æ¡Œé¢ç«¯ä»»åŠ¡å¡ç‰‡å†…å®¹ä¿æŒä¸å˜ */}
+                                <div className="flex items-start gap-4">
+                                  {/* é€‰æ‹©æ¡† */}
+                                  <div className="flex-shrink-0 pt-1">
+                                    <input
+                                      type="checkbox"
+                                      checked={selectedTasks.has(task._id)}
+                                      onChange={() => toggleTaskSelection(task._id)}
+                                      className="form-checkbox checkbox-lg"
+                                    />
+                                  </div>
+
+                                  <div className="flex-1 min-w-0">
+                                    <div className="flex flex-col lg:flex-row lg:justify-between lg:items-start gap-4">
+                                      <div className="flex-1 min-w-0">
+                                        <h3 className="font-bold text-xl text-gray-800 dark:text-gray-100 mb-2 line-clamp-2">
+                                          {task.title}
+                                        </h3>
+                                        
+                                        {/* çŠ¶æ€æ ‡ç­¾ */}
+                                        <div className="flex items-center gap-2 flex-wrap mb-2">
+                                          <span className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${getTaskStatus(task.deadline).color} ${
+                                            getTaskStatus(task.deadline).status === 'expired' 
+                                              ? 'bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-700/50'
+                                              : getTaskStatus(task.deadline).status === 'urgent'
+                                              ? 'bg-orange-100 dark:bg-orange-900/30 border border-orange-200 dark:border-orange-700/50'
+                                              : getTaskStatus(task.deadline).status === 'warning'
+                                              ? 'bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-700/50'
+                                              : 'bg-green-100 dark:bg-green-900/30 border border-green-200 dark:border-green-700/50'
+                                          }`}>
+                                            {getTaskStatus(task.deadline).text}
+                                          </span>
+                                          
+                                          <span className="inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300">
+                                            {task.category}
+                                          </span>
+                                          
+                                          {currentCategory === 'deleted' && task.daysLeft !== undefined && (
+                                            <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${
+                                              task.daysLeft > 7 
+                                                ? 'bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300'
+                                                : task.daysLeft > 3
+                                                ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300'
+                                                : 'bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300'
+                                            }`}>
+                                              {task.daysLeft}å¤©åæ°¸ä¹…åˆ é™¤
+                                            </span>
+                                          )}
+                                        </div>
+
+                                        {/* ä»»åŠ¡æè¿° */}
+                                        {task.description && (
+                                          <div className="mb-2">
+                                            <div className="bg-blue-50/60 dark:bg-blue-900/20 rounded-mobile-lg p-3 border border-blue-200/50 dark:border-blue-700/30">
+                                              <div className="flex items-start gap-2">
+                                                <ClipboardList className="w-4 h-4 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5" />
+                                                <p className="text-sm text-blue-800 dark:text-blue-200 line-clamp-3">
+                                                  {task.description}
+                                                </p>
+                                              </div>
+                                            </div>
+                                          </div>
+                                        )}
+                                      </div>
+                                    </div>
+                                    
+                                    {/* ä»»åŠ¡è¯¦æƒ…ç½‘æ ¼ */}
+                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4">
+                                      <div className="bg-gray-50/80 dark:bg-gray-800/50 rounded-mobile-lg p-3">
+                                        <div className="text-xs text-gray-500 dark:text-gray-400 mb-1 flex items-center gap-1">
+                                          <FolderOpen className="w-3.5 h-3.5" />
+                                          ä»»åŠ¡ä¿¡æ¯
+                                        </div>
+                                        <div className="space-y-1 text-sm">
+                                          <p><span className="font-medium">ç±»å‹:</span> {task.category}</p>
+                                          <p><span className="font-medium">æ–‡ä»¶:</span> {task.needsFile ? 'å¿…äº¤' : 'æ— '}</p>
+                                          <p><span className="font-medium">AIGC:</span> {task.allowAIGC ? 'å…è®¸' : 'ç¦æ­¢'}</p>
+                                          <p><span className="font-medium">ç­çº§:</span>  {task.classIds && task.classIds.length > 0
+                                            ? task.classIds.map(cls => cls.name).join('ï¼Œ')
+                                            : 'æœªç»‘å®š'}
                                         </p>
+                                        </div>
+                                      </div>
+
+                                      <div className="bg-gray-50/80 dark:bg-gray-800/50 rounded-mobile-lg p-3">
+                                        <div className="text-xs text-gray-500 dark:text-gray-400 mb-1 flex items-center gap-1">
+                                          <Clock className="w-3.5 h-3.5" />
+                                          æ—¶é—´è®¾ç½®
+                                        </div>
+                                        <div className="space-y-1 text-sm">
+                                          <p><span className="font-medium">æˆªæ­¢:</span> {formatDeadline(task.deadline)}</p>
+                                          <p><span className="font-medium">é€¾æœŸ:</span> {task.allowLateSubmission ? 'å…è®¸' : 'ä¸å…è®¸'}</p>
+                                        </div>
+                                      </div>
+
+                                      <div className="bg-gray-50/80 dark:bg-gray-800/50 rounded-mobile-lg p-3">
+                                        <div className="text-xs text-gray-500 dark:text-gray-400 mb-1 flex items-center gap-1">
+                                          <BarChart3 className="w-3.5 h-3.5" />
+                                          çŠ¶æ€ä¿¡æ¯
+                                        </div>
+                                        <div className="space-y-1 text-sm">
+                                          {currentCategory === 'archived' && (
+                                            <p><span className="font-medium">å­¦ç”ŸæŸ¥çœ‹:</span> {task.allowStudentViewWhenArchived ? 'å¼€æ”¾' : 'é™åˆ¶'}</p>
+                                          )}
+                                          <p><span className="font-medium">åˆ›å»º:</span> {new Date(task.createdAt).toLocaleDateString()}</p>
+                                        </div>
                                       </div>
                                     </div>
+                                    
+                                  {/* æ“ä½œæŒ‰é’®ç»„ */}
+                                    <div className="flex flex-wrap gap-2">
+                                      {/* æŸ¥çœ‹æäº¤è®°å½•æŒ‰é’® */}
+                                      <SecondaryButton
+                                        size="sm"
+                                        icon={<FileText className="w-4 h-4" />}
+                                        onClick={() => navigate(`/task/${task._id}/submissions`)}
+                                      >
+                                        æŸ¥çœ‹æäº¤
+                                      </SecondaryButton>
+                                      
+                                      {/* ç­çº§æäº¤æƒ…å†µæŒ‰é’® */}
+                                      <PrimaryButton
+                                        size="sm"
+                                        icon={<BarChart3 className="w-4 h-4" />}
+                                        onClick={() => navigate(`/task/${task._id}/class-status`)}
+                                      >
+                                        ç­çº§ç»Ÿè®¡
+                                      </PrimaryButton>
+
+                                        {/* æ ¹æ®ä»»åŠ¡çŠ¶æ€æ˜¾ç¤ºä¸åŒæ“ä½œæŒ‰é’® */}
+                                      {currentCategory === 'active' && (
+                                        <>
+                                          <SecondaryButton
+                                            size="sm"
+                                            icon={<Archive className="w-4 h-4" />}
+                                            onClick={() => setConfirmDialog({
+                                              isOpen: true,
+                                              title: 'ç¡®è®¤å½’æ¡£ä»»åŠ¡',
+                                              message: `ç¡®å®šè¦å½’æ¡£ä»»åŠ¡"${task.title}"å—ï¼Ÿå½’æ¡£åå­¦ç”Ÿå°†æ— æ³•æäº¤ä½œä¸šã€‚`,
+                                              onConfirm: () => {
+                                                handleTaskOperation(task._id, 'archive');
+                                                setConfirmDialog(prev => ({ ...prev, isOpen: false }));
+                                              },
+                                              confirmText: 'å½’æ¡£',
+                                              confirmVariant: 'primary'
+                                            })}
+                                            disabled={batchLoading}
+                                          >
+                                            å½’æ¡£
+                                          </SecondaryButton>
+                                          
+                                          <DangerButton
+                                            size="sm"
+                                            icon={<Trash2 className="w-4 h-4" />}
+                                            onClick={() => setConfirmDialog({
+                                              isOpen: true,
+                                              title: 'ç¡®è®¤åˆ é™¤ä»»åŠ¡',
+                                              message: `ç¡®å®šè¦åˆ é™¤ä»»åŠ¡"${task.title}"å—ï¼Ÿåˆ é™¤å30å¤©å†…å¯æ¢å¤ã€‚`,
+                                              onConfirm: () => {
+                                                handleTaskOperation(task._id, 'soft_delete');
+                                                setConfirmDialog(prev => ({ ...prev, isOpen: false }));
+                                              },
+                                              confirmText: 'åˆ é™¤',
+                                              confirmVariant: 'danger'
+                                            })}
+                                            disabled={batchLoading}
+                                          >
+                                            åˆ é™¤
+                                          </DangerButton>
+                                        </>
+                                      )}
+
+                                      {currentCategory === 'archived' && (
+                                        <>
+                                          <SecondaryButton
+                                            size="sm"
+                                            icon={<Send className="w-4 h-4" />}
+                                            onClick={() => handleTaskOperation(task._id, 'unarchive')}
+                                            disabled={batchLoading}
+                                          >
+                                            æ¢å¤
+                                          </SecondaryButton>
+                                          
+                                          <SecondaryButton
+                                            size="sm"
+                                            icon={task.allowStudentViewWhenArchived ? <Lock className="w-4 h-4" /> : <Unlock className="w-4 h-4" />}
+                                            onClick={async () => {
+                                              try {
+                                                await api.put(`/task/${task._id}/student-permission`, {
+                                                  allowStudentViewWhenArchived: !task.allowStudentViewWhenArchived
+                                                });
+                                                toast.success(' æƒé™è®¾ç½®æˆåŠŸ');
+                                                await fetchTasks(currentCategory);
+                                              } catch (err) {
+                                                toast.error(` æƒé™è®¾ç½®å¤±è´¥ï¼š${err.response?.data?.message || err.message}`);
+                                              }
+                                            }}
+                                            disabled={batchLoading}
+                                          >
+                                            {task.allowStudentViewWhenArchived ? 'é™åˆ¶æŸ¥çœ‹' : 'å¼€æ”¾æŸ¥çœ‹'}
+                                          </SecondaryButton>
+                                          
+                                          <DangerButton
+                                            size="sm"
+                                            icon={<Trash2 className="w-4 h-4" />}
+                                            onClick={() => setConfirmDialog({
+                                              isOpen: true,
+                                              title: 'ç¡®è®¤åˆ é™¤ä»»åŠ¡',
+                                              message: `ç¡®å®šè¦åˆ é™¤ä»»åŠ¡"${task.title}"å—ï¼Ÿåˆ é™¤å30å¤©å†…å¯æ¢å¤ã€‚`,
+                                              onConfirm: () => {
+                                                handleTaskOperation(task._id, 'soft_delete');
+                                                setConfirmDialog(prev => ({ ...prev, isOpen: false }));
+                                              },
+                                              confirmText: 'åˆ é™¤',
+                                              confirmVariant: 'danger'
+                                            })}
+                                            disabled={batchLoading}
+                                          >
+                                            åˆ é™¤
+                                          </DangerButton>
+                                        </>
+                                      )}
+
+                                      {currentCategory === 'deleted' && (
+                                        <>
+                                          <PrimaryButton
+                                            size="sm"
+                                            icon={<RefreshCw className="w-4 h-4" />}
+                                            onClick={() => handleTaskOperation(task._id, 'restore')}
+                                            disabled={batchLoading}
+                                          >
+                                            æ¢å¤
+                                          </PrimaryButton>
+                                          
+                                          <DangerButton
+                                            size="sm"
+                                            icon={<X className="w-4 h-4" />}
+                                            onClick={() => setConfirmDialog({
+                                              isOpen: true,
+                                              title: 'âš ï¸ æ°¸ä¹…åˆ é™¤ä»»åŠ¡',
+                                              message: `ç¡®å®šè¦æ°¸ä¹…åˆ é™¤ä»»åŠ¡"${task.title}"å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ï¼`,
+                                              onConfirm: () => {
+                                                handleTaskOperation(task._id, 'hard_delete');
+                                                setConfirmDialog(prev => ({ ...prev, isOpen: false }));
+                                              },
+                                              confirmText: 'æ°¸ä¹…åˆ é™¤',
+                                              confirmVariant: 'danger'
+                                            })}
+                                            disabled={batchLoading}
+                                          >
+                                            æ°¸ä¹…åˆ é™¤
+                                          </DangerButton>
+                                        </>
+                                      )}
+                                    </div>
                                   </div>
-                                )}
-                              </div>
-                            </div>
-                            
-                            {/* ä»»åŠ¡è¯¦æƒ…ç½‘æ ¼ */}
-                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4">
-                              <div className="bg-gray-50/80 dark:bg-gray-800/50 rounded-mobile-lg p-3">
-                                <div className="text-xs text-gray-500 dark:text-gray-400 mb-1 flex items-center gap-1">
-                                  <FolderOpen className="w-3.5 h-3.5" />
-                                  ä»»åŠ¡ä¿¡æ¯
                                 </div>
-                                <div className="space-y-1 text-sm">
-                                  <p><span className="font-medium">ç±»å‹:</span> {task.category}</p>
-                                  <p><span className="font-medium">æ–‡ä»¶:</span> {task.needsFile ? 'å¿…äº¤' : 'æ— '}</p>
-                                  <p><span className="font-medium">AIGC:</span> {task.allowAIGC ? 'å…è®¸' : 'ç¦æ­¢'}</p>
-                                  <p><span className="font-medium">ç­çº§:</span>  {task.classIds && task.classIds.length > 0
-                                    ? task.classIds.map(cls => cls.name).join('ï¼Œ')
-                                    : 'æœªç»‘å®š'}
-                                </p>
-                                </div>
-                              </div>
+                              </motion.div>
+                            )
+                          ))}
+                        </CollapsibleSection>
+                      )}
+                    </div>
+                  ) : (
+                    // ğŸ”„ å½’æ¡£ä»»åŠ¡å’Œåˆ é™¤ä»»åŠ¡ä¿æŒåŸæœ‰çš„å¹³é“ºå±•ç¤º
+                    currentTasks.map((task, index) => (
+                      isMobile ? (
+                        <motion.div
+                          key={task._id}
+                          initial={{ opacity: 0, y: 20 }}
+                          animate={{ opacity: 1, y: 0 }}
+                          transition={{ delay: index * 0.05 }}
+                        >
+                          {renderMobileTaskCard(task)}
+                        </motion.div>
+                      ) : (
+                        // ä¿æŒåŸæœ‰çš„æ¡Œé¢ç«¯æ¸²æŸ“é€»è¾‘
+                        <motion.div
+                          key={task._id}
+                          initial={{ opacity: 0, y: 20 }}
+                          animate={{ opacity: 1, y: 0 }}
+                          transition={{ delay: index * 0.05 }}
+                          className="bg-white dark:bg-gray-800 rounded-2xl shadow-md p-6 border border-gray-200 dark:border-gray-700"
+                        >
+                          {/* æ¡Œé¢ç«¯ä»»åŠ¡å¡ç‰‡å†…å®¹ä¿æŒä¸å˜ */}
+                          <div className="flex items-start gap-4">
+                            {/* é€‰æ‹©æ¡† */}
+                            <div className="flex-shrink-0 pt-1">
+                              <input
+                                type="checkbox"
+                                checked={selectedTasks.has(task._id)}
+                                onChange={() => toggleTaskSelection(task._id)}
+                                className="form-checkbox checkbox-lg"
+                              />
+                            </div>
 
-                              <div className="bg-gray-50/80 dark:bg-gray-800/50 rounded-mobile-lg p-3">
-                                <div className="text-xs text-gray-500 dark:text-gray-400 mb-1 flex items-center gap-1">
-                                  <Clock className="w-3.5 h-3.5" />
-                                  æ—¶é—´è®¾ç½®
-                                </div>
-                                <div className="space-y-1 text-sm">
-                                  <p><span className="font-medium">æˆªæ­¢:</span> {formatDeadline(task.deadline)}</p>
-                                  <p><span className="font-medium">é€¾æœŸ:</span> {task.allowLateSubmission ? 'å…è®¸' : 'ä¸å…è®¸'}</p>
+                            <div className="flex-1 min-w-0">
+                              <div className="flex flex-col lg:flex-row lg:justify-between lg:items-start gap-4">
+                                <div className="flex-1 min-w-0">
+                                  <h3 className="font-bold text-xl text-gray-800 dark:text-gray-100 mb-2 line-clamp-2">
+                                    {task.title}
+                                  </h3>
+                                  
+                                  {/* çŠ¶æ€æ ‡ç­¾ */}
+                                  <div className="flex items-center gap-2 flex-wrap mb-2">
+                                    <span className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${getTaskStatus(task.deadline).color} ${
+                                      getTaskStatus(task.deadline).status === 'expired' 
+                                        ? 'bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-700/50'
+                                        : getTaskStatus(task.deadline).status === 'urgent'
+                                        ? 'bg-orange-100 dark:bg-orange-900/30 border border-orange-200 dark:border-orange-700/50'
+                                        : getTaskStatus(task.deadline).status === 'warning'
+                                        ? 'bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-700/50'
+                                        : 'bg-green-100 dark:bg-green-900/30 border border-green-200 dark:border-green-700/50'
+                                    }`}>
+                                      {getTaskStatus(task.deadline).text}
+                                    </span>
+                                    
+                                    <span className="inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300">
+                                      {task.category}
+                                    </span>
+                                    
+                                    {currentCategory === 'deleted' && task.daysLeft !== undefined && (
+                                      <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${
+                                        task.daysLeft > 7 
+                                          ? 'bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300'
+                                          : task.daysLeft > 3
+                                          ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300'
+                                          : 'bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300'
+                                      }`}>
+                                        {task.daysLeft}å¤©åæ°¸ä¹…åˆ é™¤
+                                      </span>
+                                    )}
+                                  </div>
+
+                                  {/* ä»»åŠ¡æè¿° */}
+                                  {task.description && (
+                                    <div className="mb-2">
+                                      <div className="bg-blue-50/60 dark:bg-blue-900/20 rounded-mobile-lg p-3 border border-blue-200/50 dark:border-blue-700/30">
+                                        <div className="flex items-start gap-2">
+                                          <ClipboardList className="w-4 h-4 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5" />
+                                          <p className="text-sm text-blue-800 dark:text-blue-200 line-clamp-3">
+                                            {task.description}
+                                          </p>
+                                        </div>
+                                      </div>
+                                    </div>
+                                  )}
                                 </div>
                               </div>
+                              
+                              {/* ä»»åŠ¡è¯¦æƒ…ç½‘æ ¼ */}
+                              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4">
+                                <div className="bg-gray-50/80 dark:bg-gray-800/50 rounded-mobile-lg p-3">
+                                  <div className="text-xs text-gray-500 dark:text-gray-400 mb-1 flex items-center gap-1">
+                                    <FolderOpen className="w-3.5 h-3.5" />
+                                    ä»»åŠ¡ä¿¡æ¯
+                                  </div>
+                                  <div className="space-y-1 text-sm">
+                                    <p><span className="font-medium">ç±»å‹:</span> {task.category}</p>
+                                    <p><span className="font-medium">æ–‡ä»¶:</span> {task.needsFile ? 'å¿…äº¤' : 'æ— '}</p>
+                                    <p><span className="font-medium">AIGC:</span> {task.allowAIGC ? 'å…è®¸' : 'ç¦æ­¢'}</p>
+                                    <p><span className="font-medium">ç­çº§:</span>  {task.classIds && task.classIds.length > 0
+                                      ? task.classIds.map(cls => cls.name).join('ï¼Œ')
+                                      : 'æœªç»‘å®š'}
+                                  </p>
+                                  </div>
+                                </div>
 
-                              <div className="bg-gray-50/80 dark:bg-gray-800/50 rounded-mobile-lg p-3">
-                                <div className="text-xs text-gray-500 dark:text-gray-400 mb-1 flex items-center gap-1">
-                                  <BarChart3 className="w-3.5 h-3.5" />
-                                  çŠ¶æ€ä¿¡æ¯
+                                <div className="bg-gray-50/80 dark:bg-gray-800/50 rounded-mobile-lg p-3">
+                                  <div className="text-xs text-gray-500 dark:text-gray-400 mb-1 flex items-center gap-1">
+                                    <Clock className="w-3.5 h-3.5" />
+                                    æ—¶é—´è®¾ç½®
+                                  </div>
+                                  <div className="space-y-1 text-sm">
+                                    <p><span className="font-medium">æˆªæ­¢:</span> {formatDeadline(task.deadline)}</p>
+                                    <p><span className="font-medium">é€¾æœŸ:</span> {task.allowLateSubmission ? 'å…è®¸' : 'ä¸å…è®¸'}</p>
+                                  </div>
                                 </div>
-                                <div className="space-y-1 text-sm">
-                                  {currentCategory === 'archived' && (
-                                    <p><span className="font-medium">å­¦ç”ŸæŸ¥çœ‹:</span> {task.allowStudentViewWhenArchived ? 'å¼€æ”¾' : 'é™åˆ¶'}</p>
-                                  )}
-                                  <p><span className="font-medium">åˆ›å»º:</span> {new Date(task.createdAt).toLocaleDateString()}</p>
+
+                                <div className="bg-gray-50/80 dark:bg-gray-800/50 rounded-mobile-lg p-3">
+                                  <div className="text-xs text-gray-500 dark:text-gray-400 mb-1 flex items-center gap-1">
+                                    <BarChart3 className="w-3.5 h-3.5" />
+                                    çŠ¶æ€ä¿¡æ¯
+                                  </div>
+                                  <div className="space-y-1 text-sm">
+                                    {currentCategory === 'archived' && (
+                                      <p><span className="font-medium">å­¦ç”ŸæŸ¥çœ‹:</span> {task.allowStudentViewWhenArchived ? 'å¼€æ”¾' : 'é™åˆ¶'}</p>
+                                    )}
+                                    <p><span className="font-medium">åˆ›å»º:</span> {new Date(task.createdAt).toLocaleDateString()}</p>
+                                  </div>
                                 </div>
                               </div>
-                            </div>
-                            
-                          {/* æ“ä½œæŒ‰é’®ç»„ */}
-                            <div className="flex flex-wrap gap-2">
-                              {/* æŸ¥çœ‹æäº¤è®°å½•æŒ‰é’® */}
-                              <SecondaryButton
-                                size="sm"
-                                icon={<FileText className="w-4 h-4" />}
-                                onClick={() => navigate(`/task/${task._id}/submissions`)}
-                              >
-                                æŸ¥çœ‹æäº¤
-                              </SecondaryButton>
                               
-                              {/* ç­çº§æäº¤æƒ…å†µæŒ‰é’® */}
-                              <PrimaryButton
-                                size="sm"
-                                icon={<BarChart3 className="w-4 h-4" />}
-                                onClick={() => navigate(`/task/${task._id}/class-status`)}
-                              >
-                                ç­çº§ç»Ÿè®¡
-                              </PrimaryButton>
-
-                                {/* æ ¹æ®ä»»åŠ¡çŠ¶æ€æ˜¾ç¤ºä¸åŒæ“ä½œæŒ‰é’® */}
-                              {currentCategory === 'active' && (
-                                <>
-                                  <SecondaryButton
-                                    size="sm"
-                                    icon={<Archive className="w-4 h-4" />}
-                                    onClick={() => setConfirmDialog({
-                                      isOpen: true,
-                                      title: 'ç¡®è®¤å½’æ¡£ä»»åŠ¡',
-                                      message: `ç¡®å®šè¦å½’æ¡£ä»»åŠ¡"${task.title}"å—ï¼Ÿå½’æ¡£åå­¦ç”Ÿå°†æ— æ³•æäº¤ä½œä¸šã€‚`,
-                                      onConfirm: () => {
-                                        handleTaskOperation(task._id, 'archive');
-                                        setConfirmDialog(prev => ({ ...prev, isOpen: false }));
-                                      },
-                                      confirmText: 'å½’æ¡£',
-                                      confirmVariant: 'primary'
-                                    })}
-                                    disabled={batchLoading}
-                                  >
-                                    å½’æ¡£
-                                  </SecondaryButton>
-                                  
-                                  <DangerButton
-                                    size="sm"
-                                    icon={<Trash2 className="w-4 h-4" />}
-                                    onClick={() => setConfirmDialog({
-                                      isOpen: true,
-                                      title: 'ç¡®è®¤åˆ é™¤ä»»åŠ¡',
-                                      message: `ç¡®å®šè¦åˆ é™¤ä»»åŠ¡"${task.title}"å—ï¼Ÿåˆ é™¤å30å¤©å†…å¯æ¢å¤ã€‚`,
-                                      onConfirm: () => {
-                                        handleTaskOperation(task._id, 'soft_delete');
-                                        setConfirmDialog(prev => ({ ...prev, isOpen: false }));
-                                      },
-                                      confirmText: 'åˆ é™¤',
-                                      confirmVariant: 'danger'
-                                    })}
-                                    disabled={batchLoading}
-                                  >
-                                    åˆ é™¤
-                                  </DangerButton>
-                                </>
-                              )}
-
-                              {currentCategory === 'archived' && (
-                                <>
-                                  <SecondaryButton
-                                    size="sm"
-                                    icon={<Send className="w-4 h-4" />}
-                                    onClick={() => handleTaskOperation(task._id, 'unarchive')}
-                                    disabled={batchLoading}
-                                  >
-                                    æ¢å¤
-                                  </SecondaryButton>
-                                  
-                                  <SecondaryButton
-                                    size="sm"
-                                    icon={task.allowStudentViewWhenArchived ? <Lock className="w-4 h-4" /> : <Unlock className="w-4 h-4" />}
-                                    onClick={async () => {
-                                      try {
-                                        await api.put(`/task/${task._id}/student-permission`, {
-                                          allowStudentViewWhenArchived: !task.allowStudentViewWhenArchived
-                                        });
-                                        toast.success(' æƒé™è®¾ç½®æˆåŠŸ');
-                                        await fetchTasks(currentCategory);
-                                      } catch (err) {
-                                        toast.error(` æƒé™è®¾ç½®å¤±è´¥ï¼š${err.response?.data?.message || err.message}`);
-                                      }
-                                    }}
-                                    disabled={batchLoading}
-                                  >
-                                    {task.allowStudentViewWhenArchived ? 'é™åˆ¶æŸ¥çœ‹' : 'å¼€æ”¾æŸ¥çœ‹'}
-                                  </SecondaryButton>
-                                  
-                                  <DangerButton
-                                    size="sm"
-                                    icon={<Trash2 className="w-4 h-4" />}
-                                    onClick={() => setConfirmDialog({
-                                      isOpen: true,
-                                      title: 'ç¡®è®¤åˆ é™¤ä»»åŠ¡',
-                                      message: `ç¡®å®šè¦åˆ é™¤ä»»åŠ¡"${task.title}"å—ï¼Ÿåˆ é™¤å30å¤©å†…å¯æ¢å¤ã€‚`,
-                                      onConfirm: () => {
-                                        handleTaskOperation(task._id, 'soft_delete');
-                                        setConfirmDialog(prev => ({ ...prev, isOpen: false }));
-                                      },
-                                      confirmText: 'åˆ é™¤',
-                                      confirmVariant: 'danger'
-                                    })}
-                                    disabled={batchLoading}
-                                  >
-                                    åˆ é™¤
-                                  </DangerButton>
-                                </>
-                              )}
-
-                              {currentCategory === 'deleted' && (
-                                <>
-                                  <PrimaryButton
-                                    size="sm"
-                                    icon={<RefreshCw className="w-4 h-4" />}
-                                    onClick={() => handleTaskOperation(task._id, 'restore')}
-                                    disabled={batchLoading}
-                                  >
-                                    æ¢å¤
-                                  </PrimaryButton>
-                                  
-                                  <DangerButton
-                                    size="sm"
-                                    icon={<X className="w-4 h-4" />}
-                                    onClick={() => setConfirmDialog({
-                                      isOpen: true,
-                                      title: 'âš ï¸ æ°¸ä¹…åˆ é™¤ä»»åŠ¡',
-                                      message: `ç¡®å®šè¦æ°¸ä¹…åˆ é™¤ä»»åŠ¡"${task.title}"å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ï¼`,
-                                      onConfirm: () => {
-                                        handleTaskOperation(task._id, 'hard_delete');
-                                        setConfirmDialog(prev => ({ ...prev, isOpen: false }));
-                                      },
-                                      confirmText: 'æ°¸ä¹…åˆ é™¤',
-                                      confirmVariant: 'danger'
-                                    })}
-                                    disabled={batchLoading}
-                                  >
-                                    æ°¸ä¹…åˆ é™¤
-                                  </DangerButton>
-                                </>
-                              )}
+                            {/* æ“ä½œæŒ‰é’®ç»„ */}
+                              <div className="flex flex-wrap gap-2">
+                                {/* æŸ¥çœ‹æäº¤è®°å½•æŒ‰é’® */}
+                                <SecondaryButton
+                                  size="sm"
+                                  icon={<FileText className="w-4 h-4" />}
+                                  onClick={() => navigate(`/task/${task._id}/submissions`)}
+                                >
+                                  æŸ¥çœ‹æäº¤
+                                </SecondaryButton>
+                                
+                                {/* ç­çº§æäº¤æƒ…å†µæŒ‰é’® */}
+                                <PrimaryButton
+                                  size="sm"
+                                  icon={<BarChart3 className="w-4 h-4" />}
+                                  onClick={() => navigate(`/task/${task._id}/class-status`)}
+                                >
+                                  ç­çº§ç»Ÿè®¡
+                                </PrimaryButton>
+
+                                  {/* æ ¹æ®ä»»åŠ¡çŠ¶æ€æ˜¾ç¤ºä¸åŒæ“ä½œæŒ‰é’® */}
+                                {currentCategory === 'active' && (
+                                  <>
+                                    <SecondaryButton
+                                      size="sm"
+                                      icon={<Archive className="w-4 h-4" />}
+                                      onClick={() => setConfirmDialog({
+                                        isOpen: true,
+                                        title: 'ç¡®è®¤å½’æ¡£ä»»åŠ¡',
+                                        message: `ç¡®å®šè¦å½’æ¡£ä»»åŠ¡"${task.title}"å—ï¼Ÿå½’æ¡£åå­¦ç”Ÿå°†æ— æ³•æäº¤ä½œä¸šã€‚`,
+                                        onConfirm: () => {
+                                          handleTaskOperation(task._id, 'archive');
+                                          setConfirmDialog(prev => ({ ...prev, isOpen: false }));
+                                        },
+                                        confirmText: 'å½’æ¡£',
+                                        confirmVariant: 'primary'
+                                      })}
+                                      disabled={batchLoading}
+                                    >
+                                      å½’æ¡£
+                                    </SecondaryButton>
+                                    
+                                    <DangerButton
+                                      size="sm"
+                                      icon={<Trash2 className="w-4 h-4" />}
+                                      onClick={() => setConfirmDialog({
+                                        isOpen: true,
+                                        title: 'ç¡®è®¤åˆ é™¤ä»»åŠ¡',
+                                        message: `ç¡®å®šè¦åˆ é™¤ä»»åŠ¡"${task.title}"å—ï¼Ÿåˆ é™¤å30å¤©å†…å¯æ¢å¤ã€‚`,
+                                        onConfirm: () => {
+                                          handleTaskOperation(task._id, 'soft_delete');
+                                          setConfirmDialog(prev => ({ ...prev, isOpen: false }));
+                                        },
+                                        confirmText: 'åˆ é™¤',
+                                        confirmVariant: 'danger'
+                                      })}
+                                      disabled={batchLoading}
+                                    >
+                                      åˆ é™¤
+                                    </DangerButton>
+                                  </>
+                                )}
+
+                                {currentCategory === 'archived' && (
+                                  <>
+                                    <SecondaryButton
+                                      size="sm"
+                                      icon={<Send className="w-4 h-4" />}
+                                      onClick={() => handleTaskOperation(task._id, 'unarchive')}
+                                      disabled={batchLoading}
+                                    >
+                                      æ¢å¤
+                                    </SecondaryButton>
+                                    
+                                    <SecondaryButton
+                                      size="sm"
+                                      icon={task.allowStudentViewWhenArchived ? <Lock className="w-4 h-4" /> : <Unlock className="w-4 h-4" />}
+                                      onClick={async () => {
+                                        try {
+                                          await api.put(`/task/${task._id}/student-permission`, {
+                                            allowStudentViewWhenArchived: !task.allowStudentViewWhenArchived
+                                          });
+                                          toast.success(' æƒé™è®¾ç½®æˆåŠŸ');
+                                          await fetchTasks(currentCategory);
+                                        } catch (err) {
+                                          toast.error(` æƒé™è®¾ç½®å¤±è´¥ï¼š${err.response?.data?.message || err.message}`);
+                                        }
+                                      }}
+                                      disabled={batchLoading}
+                                    >
+                                      {task.allowStudentViewWhenArchived ? 'é™åˆ¶æŸ¥çœ‹' : 'å¼€æ”¾æŸ¥çœ‹'}
+                                    </SecondaryButton>
+                                    
+                                    <DangerButton
+                                      size="sm"
+                                      icon={<Trash2 className="w-4 h-4" />}
+                                      onClick={() => setConfirmDialog({
+                                        isOpen: true,
+                                        title: 'ç¡®è®¤åˆ é™¤ä»»åŠ¡',
+                                        message: `ç¡®å®šè¦åˆ é™¤ä»»åŠ¡"${task.title}"å—ï¼Ÿåˆ é™¤å30å¤©å†…å¯æ¢å¤ã€‚`,
+                                        onConfirm: () => {
+                                          handleTaskOperation(task._id, 'soft_delete');
+                                          setConfirmDialog(prev => ({ ...prev, isOpen: false }));
+                                        },
+                                        confirmText: 'åˆ é™¤',
+                                        confirmVariant: 'danger'
+                                      })}
+                                      disabled={batchLoading}
+                                    >
+                                      åˆ é™¤
+                                    </DangerButton>
+                                  </>
+                                )}
+
+                                {currentCategory === 'deleted' && (
+                                  <>
+                                    <PrimaryButton
+                                      size="sm"
+                                      icon={<RefreshCw className="w-4 h-4" />}
+                                      onClick={() => handleTaskOperation(task._id, 'restore')}
+                                      disabled={batchLoading}
+                                    >
+                                      æ¢å¤
+                                    </PrimaryButton>
+                                    
+                                    <DangerButton
+                                      size="sm"
+                                      icon={<X className="w-4 h-4" />}
+                                      onClick={() => setConfirmDialog({
+                                        isOpen: true,
+                                        title: 'âš ï¸ æ°¸ä¹…åˆ é™¤ä»»åŠ¡',
+                                        message: `ç¡®å®šè¦æ°¸ä¹…åˆ é™¤ä»»åŠ¡"${task.title}"å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ï¼`,
+                                        onConfirm: () => {
+                                          handleTaskOperation(task._id, 'hard_delete');
+                                          setConfirmDialog(prev => ({ ...prev, isOpen: false }));
+                                        },
+                                        confirmText: 'æ°¸ä¹…åˆ é™¤',
+                                        confirmVariant: 'danger'
+                                      })}
+                                      disabled={batchLoading}
+                                    >
+                                      æ°¸ä¹…åˆ é™¤
+                                    </DangerButton>
+                                  </>
+                                )}
+                              </div>
                             </div>
                           </div>
-                        </div>
-                      </motion.div>
-                    )
-                  ))}
+                        </motion.div>
+                      )
+                    ))
+                  )}
                 </motion.div>
               )}
             </AnimatePresence>
